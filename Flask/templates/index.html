{% extends 'base.html' %}

{% block head %}
<title>Airlines Database - Home</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-chart-matrix@2.0.1"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-chart-matrix@1.1.1/dist/chartjs-chart-matrix.min.js"></script>
<script src="https://unpkg.com/@sgratzl/chartjs-chart-boxplot@3.6.0/build/index.umd.min.js"></script>

{% endblock %}

{% block body %}
<section class="hero-section" id="hero">
    <div class="container" id="homeContainer">
        <div class="row">
            <div class="col-12">
                <h1 id="Welcome">WELCOME</h1>
                <h4>AIRLINE ANALYTICS & MANAGEMENT SYSTEM</h4>
                
                <div class="landing-actions">
                    <button onclick="document.getElementById('dashboard').scrollIntoView({behavior: 'smooth'})" class="btn-landing">
                        <i class="fas fa-chart-line"></i> View Analytics
                    </button>
                    
                    <a href="{{ url_for('manage') }}" class="btn-landing btn-landing-outline">
                        <i class="fas fa-database"></i> Manage Database
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="scroll-indicator" onclick="document.getElementById('dashboard').scrollIntoView({behavior: 'smooth'})">
        <i class="fas fa-chevron-down"></i>
        <p style="margin-top: 10px; font-size: 0.9rem;">Scroll for Dashboard</p>
    </div>
</section>

<section class="dashboard-section" id="dashboard">
    <div class="container">
        <div class="dashboard-header">
            <h2 id="dashboard-title">Relational Database Analytics</h2>
            
            <div class="db-toggle-container">
                <span class="toggle-label" id="db-label-sql" style="color: #2196F3;">SQL</span>
                <label class="switch">
                    <input type="checkbox" id="dashboardToggle" onchange="toggleDashboardSource()">
                    <span class="slider"></span>
                </label>
                <span class="toggle-label" id="db-label-nosql" style="color: #aaa;">NoSQL</span>
            </div>

            <p>Real-time insights from your flight operations data</p>
        </div>
        
        <div class="row metrics-row" id="keyMetrics">
            <div class="col-md-3">
                <div class="metric-card">
                    <h3>Total Flights</h3>
                    <div class="metric-value" id="totalFlights">-</div>
                    <div class="metric-label">Operations</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="metric-card">
                    <h3>On-Time Rate</h3>
                    <div class="metric-value" id="ontimeRate">-</div>
                    <div class="metric-label">Performance</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="metric-card">
                    <h3>Avg Delay</h3>
                    <div class="metric-value" id="avgDelay">-</div>
                    <div class="metric-label">Minutes</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="metric-card">
                    <h3>Cancellations</h3>
                    <div class="metric-value" id="cancellations">-</div>
                    <div class="metric-label">Flights</div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>1. Top 5 Least Punctual Routes</h4>
                    <div class="chart-container">
                        <canvas id="punctualChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>5. Top 10 Routes by Flight Volume</h4>
                    <div class="chart-container">
                        <canvas id="routesChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>2. Top 10 Routes by Average Occupancy Rate</h4>
                    <div class="chart-container">
                        <canvas id="occupancyChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>3. Busiest Routes by Market Share % (Heatmap)</h4>
                    <div class="chart-container">
                        <canvas id="marketShareChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>4. 10 Least Busy Routes by Market Share %</h4>
                    <div class="chart-container">
                        <canvas id="leastBusyChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>6a. Top 3 Most Profitable Routes</h4>
                    <div class="chart-container">
                        <canvas id="profitableRoutesChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>6b. Top 3 Least Profitable Routes</h4>
                    <div class="chart-container">
                        <canvas id="leastProfitableChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>7a. Revenue by Fare Class</h4>
                    <div class="chart-container">
                        <canvas id="revenueClassChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-12">
                <div class="chart-card">
                    <h4>7b. Top 20 Revenue by Fare Class & Route</h4>
                    <div class="chart-container">
                        <canvas id="revenueClassRouteChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>8. Top 20 Aircraft Type by Route</h4>
                    <div class="chart-container">
                        <canvas id="aircraftRouteChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>9. Top 3 Most Visited Destinations</h4>
                    <div class="chart-container">
                        <canvas id="destinationsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>10. Top 10 Planes with Most Mileage</h4>
                    <div class="chart-container">
                        <canvas id="utilizationChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h4 style="margin: 0;">11. Routes Taken by Aircraft (Top 50)</h4>
                        <select id="aircraftFilter" class="form-select form-select-sm" style="width: auto; min-width: 200px;">
                            <option value="">Loading...</option>
                        </select>
                    </div>
                    <div class="chart-container" style="overflow-y: auto; max-height: 400px;">
                        <table class="table table-sm table-hover">
                            <thead class="table-dark" style="position: sticky; top: 0; z-index: 10;">
                                <tr>
                                    <th>Flight ID</th>
                                    <th>Route</th>
                                    <th>Departure</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="su9RoutesBody">
                                <tr><td colspan="4" class="text-center">Loading...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script src="{{ url_for('static', filename='JS/siteJS.js') }}"></script>
{% endblock %}