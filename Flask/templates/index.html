{% extends 'base.html' %}

{% block head %}
<title>Airlines Database - Home</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-chart-matrix@2.0.1"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-chart-matrix@1.1.1/dist/chartjs-chart-matrix.min.js"></script>
<script src="https://unpkg.com/@sgratzl/chartjs-chart-boxplot@3.6.0/build/index.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-chart-treemap@2.3.0/dist/chartjs-chart-treemap.min.js"></script>

{% endblock %}

{% block body %}
<section class="hero-section" id="hero">
    <div class="container" id="homeContainer">
        <div class="row">
            <div class="col-12">
                <h1 id="Welcome">WELCOME</h1>
                <h4>AIRLINE ANALYTICS & MANAGEMENT SYSTEM</h4>
                
                <div class="landing-actions">
                    <button onclick="document.getElementById('dashboard').scrollIntoView({behavior: 'smooth'})" class="btn-landing">
                        <i class="fas fa-chart-line"></i> View Analytics
                    </button>
                    
                    <a href="{{ url_for('manage') }}" class="btn-landing btn-landing-outline">
                        <i class="fas fa-database"></i> Manage Database
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="scroll-indicator" onclick="document.getElementById('dashboard').scrollIntoView({behavior: 'smooth'})">
        <i class="fas fa-chevron-down"></i>
        <p style="margin-top: 10px; font-size: 0.9rem;">Scroll for Dashboard</p>
    </div>
</section>

<section class="dashboard-section" id="dashboard">
    <div class="container">
        <div class="dashboard-header">
            <h2 id="dashboard-title">Relational Database Analytics</h2>
            
            <div class="db-toggle-container">
                <span class="toggle-label" id="db-label-sql" style="color: #2196F3;">SQL</span>
                <label class="switch">
                    <input type="checkbox" id="dashboardToggle" onchange="toggleDashboardSource()">
                    <span class="slider"></span>
                </label>
                <span class="toggle-label" id="db-label-nosql" style="color: #aaa;">NoSQL</span>
            </div>

            <p>Real-time insights from your flight operations data</p>
        </div>
        
        <div class="row metrics-row" id="keyMetrics">
            <div class="col-md-3">
                <div class="metric-card">
                    <h3>Total Flights</h3>
                    <div class="metric-value" id="totalFlights">-</div>
                    <div class="metric-label">Operations</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="metric-card">
                    <h3>On-Time Rate</h3>
                    <div class="metric-value" id="ontimeRate">-</div>
                    <div class="metric-label">Performance</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="metric-card">
                    <h3>Avg Delay</h3>
                    <div class="metric-value" id="avgDelay">-</div>
                    <div class="metric-label">Minutes</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="metric-card">
                    <h3>Cancellations</h3>
                    <div class="metric-value" id="cancellations">-</div>
                    <div class="metric-label">Flights</div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>Routes with Avg Delay > 60 Mins</h4>
                    <div class="chart-container">
                        <canvas id="punctualChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>Top 10 Routes by Flight Volume</h4>
                    <div class="chart-container">
                        <canvas id="routesChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>Top 10 Routes by Average Occupancy Rate</h4>
                    <div class="chart-container">
                        <canvas id="occupancyChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>Revenue by Fare Class</h4>
                    <div class="chart-container">
                        <canvas id="revenueClassChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>Top 10 Busiest Routes by Market Share % </h4>
                    <div class="chart-container">
                        <canvas id="marketShareChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>10 Least Busy Routes by Market Share %</h4>
                    <div class="chart-container">
                        <canvas id="leastBusyChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>Top 3 Most Profitable Routes</h4>
                    <div class="chart-container">
                        <canvas id="profitableRoutesChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>Top 3 Least Profitable Routes</h4>
                    <div class="chart-container">
                        <canvas id="leastProfitableChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-12">
                <div class="chart-card">
                    <h4>Top 20 Revenue by Fare Class & Route</h4>
                    <div class="chart-container">
                        <canvas id="revenueClassRouteChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="chart-card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h4 style="margin: 0;">Flight Frequency by Route & Aircraft</h4>
                        <select id="routeSelect" class="form-select form-select-sm" style="width: auto; max-width: 200px;" onchange="renderFilteredAircraftChart()">
                            <option value="ALL">Show Top 15 Routes</option>
                        </select>
                    </div>
                    <div class="chart-container">
                        <canvas id="aircraftRouteChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>Top 3 Most Visited Destinations</h4>
                    <div class="chart-container">
                        <canvas id="destinationsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>Top 5 Planes with Most Mileage</h4>
                    <div class="chart-container">
                        <canvas id="utilizationChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-card">
                    <h4>Avg Delay vs. Cancellations by Aircraft</h4>
                    <div class="chart-container">
                        <canvas id="cancellationDelayChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{% endblock %}